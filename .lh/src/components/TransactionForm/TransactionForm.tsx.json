{
    "sourceFile": "src/components/TransactionForm/TransactionForm.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 32,
            "patches": [
                {
                    "date": 1748047823927,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1748048253347,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1171,4 +1171,153 @@\n       </TooltipProvider>\n     </QueryClientProvider>\n   );\n }\n+\n+\n+// Add checkMobile function at the top of the file\n+const checkMobile = () => {\n+  if (typeof window === 'undefined') return false;\n+  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n+};\n+\n+\n+{currentStep === 9 && (\n+  <>\n+    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n+      {/* Sign & Submit section header with pen icon */}\n+      <div className=\"flex items-center mb-1\">\n+        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 shadow-md mr-2 animated-badge\">\n+          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n+            <path d=\"M12 19L19 12L22 15L15 22L12 19Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+            <path d=\"M18 13L16.5 5.5L2 2L5.5 16.5L13 18L18 13Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+            <path d=\"M2 2L9.586 9.586\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+            <path d=\"M11 13C12.1046 13 13 12.1046 13 11C13 9.89543 12.1046 9 11 9C9.89543 9 9 9.89543 9 11C9 12.1046 9.89543 13 11 13Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+          </svg>\n+        </div>\n+        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Sign & Submit</h2>\n+      </div>\n+      <div className=\"fancy-divider my-2\"></div>\n+      <p className=\"text-blue-100 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/40 ml-1\">\n+        Please sign below to confirm all information is correct and to submit your transaction.\n+      </p>\n+    </div>\n+\n+    {/* Signature Section with enhanced styling */}\n+    <div className=\"w-full\">\n+      <div className=\"bg-transparent rounded-xl p-4 border border-slate-700/30 shadow-lg relative overflow-hidden\">\n+        {/* Subtle visual accent */}\n+        <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-green-400 via-green-500 to-green-600\"></div>\n+        <div className=\"absolute -top-14 -right-14 w-28 h-28 bg-green-500/10 rounded-full\"></div>\n+        <div className=\"absolute -bottom-10 -left-10 w-20 h-20 bg-green-500/10 rounded-full\"></div>\n+\n+        <SignatureSection\n+          data={signatureData}\n+          onChange={(field, value) => setSignatureData(prev => ({ ...prev, [field]: value }))}\n+          role={agentData.role}\n+          skippedFields={[]}\n+          onFieldFix={handleFixField}\n+        />\n+      </div>\n+    </div>\n+  </>\n+)}\n+{\n+  /* Emit step change events */\n+  useEffect(() => {\n+    // Notify the parent component of step changes\n+    const event = new CustomEvent('stepChange', {\n+      detail: { step: currentStep }\n+    });\n+    window.dispatchEvent(event);\n+  }, [currentStep]);\n+\n+  // Set the data attribute when component mounts and remove on unmount\n+  useEffect(() => {\n+    document.body.setAttribute('data-transaction-page', 'true');\n+\n+    return () => {\n+      document.body.removeAttribute('data-transaction-page');\n+    };\n+  }, []);\n+\n+  return (\n+    <QueryClientProvider client={queryClient}>\n+      <TooltipProvider>\n+        {/* Add style tag for dropdown fixes */}\n+        <style dangerouslySetInnerHTML={{ __html: fixDropdownStyles }} />\n+\n+        <div ref={formContainerRef} className=\"transaction-form-container flex flex-col bg-blue-900/95 rounded-xl shadow-md min-h-screen\">\n+          <div className=\"container mx-auto px-1 sm:px-3 py-1 sm:py-3 flex-grow flex flex-col overflow-visible\">\n+            {/* Main form container with enhanced visual design */}\n+            <div ref={formContentRef} className=\"modern-form-container bg-transparent rounded-xl p-2 sm:p-3 border-0 relative flex flex-col flex-grow\" style={{ backgroundColor: 'transparent', boxShadow: 'none' }}>\n+              {/* Decorative corner accents for visual polish */}\n+              <div className=\"absolute top-0 left-0 w-12 h-12 border-t-2 border-l-2 border-blue-500/20 rounded-tl-xl pointer-events-none\"></div>\n+              <div className=\"absolute top-0 right-0 w-12 h-12 border-t-2 border-r-2 border-blue-500/20 rounded-tr-xl pointer-events-none\"></div>\n+              <div className=\"absolute bottom-0 left-0 w-12 h-12 border-b-2 border-l-2 border-blue-500/10 rounded-bl-xl pointer-events-none hidden md:block\"></div>\n+              <div className=\"absolute bottom-0 right-0 w-12 h-12 border-b-2 border-r-2 border-blue-500/10 rounded-br-xl pointer-events-none hidden md:block\"></div>\n+\n+              {/* Form Content with section fade-in effect */}\n+              <div className=\"space-y-4 section-fade-in flex-grow overflow-visible min-h-[400px] pb-16\" style={{ backgroundColor: 'transparent' }}>\n+                {currentStep === 1 && (\n+                  <>\n+                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n+                      {/* Enhanced section header with icon and gradient accent */}\n+                      <div className=\"flex items-center mb-1\">\n+                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-white/30 to-white/10 shadow-md mr-2 border border-white/20\">\n+                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n+                            <path d=\"M14.5 22V12C14.5 10.8954 13.6046 10 12.5 10H6.5C5.39543 10 4.5 10.8954 4.5 12V22\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+                            <path d=\"M2.5 22H21.5\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+                            <path d=\"M19.5 22V6C19.5 4.89543 18.6046 4 17.5 4H14.5C13.3954 4 12.5 4.89543 12.5 6V10\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+                            <path d=\"M7.5 22V17H11.5V22\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+                          </svg>\n+                        </div>\n+                        <h2 className=\"text-lg sm:text-xl font-bold text-white\">Select Your Role</h2>\n+                      </div>\n+                      <div className=\"border-t border-white/10 my-2\"></div>\n+                      <p className=\"text-white/80 text-xs sm:text-sm pl-2 border-l-4 border-white/30 ml-1\">\n+                        This form will guide you through submitting a new real estate transaction. Please select your role to get started.\n+                      </p>\n+                    </div>\n+                    <div className=\"flex-grow flex flex-col justify-center py-8\">\n+                      <RoleSelection\n+                        selectedRole={agentData.role}\n+                        onRoleChange={(value) => setAgentData(prev => ({ ...prev, role: value }))}\n+                        agentName={agentData.name}\n+                        onAgentNameChange={(value) => {\n+                          setAgentData(prev => ({ ...prev, name: value }));\n+                          // Also update the signature data to keep it in sync\n+                          setSignatureData(prev => ({ ...prev, agentName: value }));\n+                        }}\n+                      />\n+                    </div>\n+                  </>\n+                )}\n+                {currentStep === 2 && (\n+                  <>\n+                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n+                      {/* Property Information section header with home icon */}\n+                      <div className=\"flex items-center mb-1\">\n+                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 shadow-md mr-2\">\n+                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n+                            <path d=\"M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+                            <path d=\"M9 22V12H15V22\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n+                          </svg>\n+                        </div>\n+                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Property Information</h2>\n+                      </div>\n+                      <div className=\"fancy-divider my-2\"></div>\n+                      <p className=\"text-gray-600 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/30 ml-1\">\n+                        Enter property details for this transaction.\n+                      </p>\n+                    </div>\n+                    <div className=\"flex-grow py-6\">\n+                      <PropertyInformation\n+                        data={propertyData}\n+                        onChange={(field, value) => setPropertyData(prev => ({ ...prev, [field]: value }))}\n+                        role={agentData.role}\n+                      />\n+                    </div>\n+                  </>\n+                )}\n+                {currentStep === 3 && (\n+                  <>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1748048294560,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,8 +6,14 @@\n import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\n import type { AgentRole, Client } from '@/types/transaction';\n // All TransactionForm CSS is now consolidated in src/styles/pages/transaction-form.css\n \n+// Helper function to detect mobile devices\n+const checkMobile = () => {\n+  if (typeof window === 'undefined') return false;\n+  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n+};\n+\n // Import components\n import { RoleSelection } from \"@/components/TransactionForm/RoleSelection\";\n import { PropertyInformation } from \"@/components/TransactionForm/PropertyInformation\";\n import { ClientInformation } from \"@/components/TransactionForm/ClientInformation\";\n"
                },
                {
                    "date": 1748048759699,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,11 @@\n import { Toaster } from \"@/components/ui/toaster\";\n import { TooltipProvider } from \"@/components/ui/tooltip\";\n import { Toaster as SonnerToaster } from \"@/components/ui/sonner\";\n import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\n+\n+// Initialize QueryClient outside the component\n+const queryClient = new QueryClient();\n import type { AgentRole, Client } from '@/types/transaction';\n // All TransactionForm CSS is now consolidated in src/styles/pages/transaction-form.css\n \n // Helper function to detect mobile devices\n"
                },
                {
                    "date": 1748048766196,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,12 +3,12 @@\n import { Toaster } from \"@/components/ui/toaster\";\n import { TooltipProvider } from \"@/components/ui/tooltip\";\n import { Toaster as SonnerToaster } from \"@/components/ui/sonner\";\n import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\n+import type { AgentRole, Client } from '@/types/transaction';\n \n // Initialize QueryClient outside the component\n const queryClient = new QueryClient();\n-import type { AgentRole, Client } from '@/types/transaction';\n // All TransactionForm CSS is now consolidated in src/styles/pages/transaction-form.css\n \n // Helper function to detect mobile devices\n const checkMobile = () => {\n"
                },
                {
                    "date": 1748048779570,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1230,9 +1230,9 @@\n     </div>\n   </>\n )}\n {\n-  /* Emit step change events */\n+export const TransactionForm = () => {\n   useEffect(() => {\n     // Notify the parent component of step changes\n     const event = new CustomEvent('stepChange', {\n       detail: { step: currentStep }\n@@ -1328,5 +1328,5 @@\n                     </div>\n                   </>\n                 )}\n                 {currentStep === 3 && (\n-                  <>\n\\ No newline at end of file\n+                  <>\n"
                },
                {
                    "date": 1748048795000,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,10 +5,8 @@\n import { Toaster as SonnerToaster } from \"@/components/ui/sonner\";\n import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\n import type { AgentRole, Client } from '@/types/transaction';\n \n-// Initialize QueryClient outside the component\n-const queryClient = new QueryClient();\n // All TransactionForm CSS is now consolidated in src/styles/pages/transaction-form.css\n \n // Helper function to detect mobile devices\n const checkMobile = () => {\n@@ -90,11 +88,8 @@\n     opacity: 1 !important;\n   }\n `;\n \n-// Create a new QueryClient instance\n-const queryClient = new QueryClient();\n-\n // Define the form steps for the StepWizard\n const formSteps = [\n   { id: 1, title: \"Agent Role\", icon: \"user\" },\n   { id: 2, title: \"Property\", icon: \"home\" },\n"
                },
                {
                    "date": 1748048804849,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,8 +88,11 @@\n     opacity: 1 !important;\n   }\n `;\n \n+// Initialize QueryClient outside the component\n+const queryClient = new QueryClient();\n+\n // Define the form steps for the StepWizard\n const formSteps = [\n   { id: 1, title: \"Agent Role\", icon: \"user\" },\n   { id: 2, title: \"Property\", icon: \"home\" },\n@@ -1226,8 +1229,10 @@\n   </>\n )}\n {\n export const TransactionForm = () => {\n+  const [currentStep, setCurrentStep] = useState(1);\n+\n   useEffect(() => {\n     // Notify the parent component of step changes\n     const event = new CustomEvent('stepChange', {\n       detail: { step: currentStep }\n"
                },
                {
                    "date": 1748048820883,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1226,10 +1226,10 @@\n         />\n       </div>\n     </div>\n   </>\n-)}\n-{\n+);\n+\n export const TransactionForm = () => {\n   const [currentStep, setCurrentStep] = useState(1);\n \n   useEffect(() => {\n"
                },
                {
                    "date": 1748048835390,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1186,10 +1186,13 @@\n   if (typeof window === 'undefined') return false;\n   return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n };\n \n+export const TransactionForm = () => {\n+  const [currentStep, setCurrentStep] = useState(1);\n+  // Add other necessary state declarations here\n \n-{currentStep === 9 && (\n+  {currentStep === 9 && (\n   <>\n     <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n       {/* Sign & Submit section header with pen icon */}\n       <div className=\"flex items-center mb-1\">\n"
                },
                {
                    "date": 1748048850018,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,8 +13,11 @@\n   if (typeof window === 'undefined') return false;\n   return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n };\n \n+// Initialize QueryClient outside the component\n+const queryClient = new QueryClient();\n+\n // Import components\n import { RoleSelection } from \"@/components/TransactionForm/RoleSelection\";\n import { PropertyInformation } from \"@/components/TransactionForm/PropertyInformation\";\n import { ClientInformation } from \"@/components/TransactionForm/ClientInformation\";\n"
                },
                {
                    "date": 1748048861372,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,17 +7,8 @@\n import type { AgentRole, Client } from '@/types/transaction';\n \n // All TransactionForm CSS is now consolidated in src/styles/pages/transaction-form.css\n \n-// Helper function to detect mobile devices\n-const checkMobile = () => {\n-  if (typeof window === 'undefined') return false;\n-  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n-};\n-\n-// Initialize QueryClient outside the component\n-const queryClient = new QueryClient();\n-\n // Import components\n import { RoleSelection } from \"@/components/TransactionForm/RoleSelection\";\n import { PropertyInformation } from \"@/components/TransactionForm/PropertyInformation\";\n import { ClientInformation } from \"@/components/TransactionForm/ClientInformation\";\n@@ -91,11 +82,8 @@\n     opacity: 1 !important;\n   }\n `;\n \n-// Initialize QueryClient outside the component\n-const queryClient = new QueryClient();\n-\n // Define the form steps for the StepWizard\n const formSteps = [\n   { id: 1, title: \"Agent Role\", icon: \"user\" },\n   { id: 2, title: \"Property\", icon: \"home\" },\n@@ -1189,13 +1177,9 @@\n   if (typeof window === 'undefined') return false;\n   return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n };\n \n-export const TransactionForm = () => {\n-  const [currentStep, setCurrentStep] = useState(1);\n-  // Add other necessary state declarations here\n-\n-  {currentStep === 9 && (\n+{currentStep === 9 && (\n   <>\n     <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n       {/* Sign & Submit section header with pen icon */}\n       <div className=\"flex items-center mb-1\">\n"
                },
                {
                    "date": 1748048874465,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,8 +5,17 @@\n import { Toaster as SonnerToaster } from \"@/components/ui/sonner\";\n import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\n import type { AgentRole, Client } from '@/types/transaction';\n \n+// Helper function to detect mobile devices\n+const checkMobile = () => {\n+  if (typeof window === 'undefined') return false;\n+  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n+};\n+\n+// Initialize QueryClient outside the component\n+const queryClient = new QueryClient();\n+\n // All TransactionForm CSS is now consolidated in src/styles/pages/transaction-form.css\n \n // Import components\n import { RoleSelection } from \"@/components/TransactionForm/RoleSelection\";\n"
                },
                {
                    "date": 1748048882522,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,8 +93,16 @@\n `;\n \n // Define the form steps for the StepWizard\n const formSteps = [\n+\n+export const TransactionForm = () => {\n+  const [currentStep, setCurrentStep] = useState(1);\n+  const formContainerRef = useRef(null);\n+  const formContentRef = useRef(null);\n+\n+  // Add your existing state declarations and hooks here\n+\n   { id: 1, title: \"Agent Role\", icon: \"user\" },\n   { id: 2, title: \"Property\", icon: \"home\" },\n   { id: 3, title: \"Clients\", icon: \"users\" },\n   { id: 4, title: \"Commission\", icon: \"dollar-sign\" },\n"
                },
                {
                    "date": 1748048892935,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,20 +91,13 @@\n     opacity: 1 !important;\n   }\n `;\n \n-// Define the form steps for the StepWizard\n-const formSteps = [\n-\n export const TransactionForm = () => {\n-  const [currentStep, setCurrentStep] = useState(1);\n-  const formContainerRef = useRef(null);\n-  const formContentRef = useRef(null);\n-\n-  // Add your existing state declarations and hooks here\n-\n-  { id: 1, title: \"Agent Role\", icon: \"user\" },\n-  { id: 2, title: \"Property\", icon: \"home\" },\n+  // Define form steps\n+  const formSteps = [\n+    { id: 1, title: \"Agent Role\", icon: \"user\" },\n+    { id: 2, title: \"Property\", icon: \"home\" },\n   { id: 3, title: \"Clients\", icon: \"users\" },\n   { id: 4, title: \"Commission\", icon: \"dollar-sign\" },\n   { id: 5, title: \"Property Details\", icon: \"clipboard\" },\n   { id: 6, title: \"Documents\", icon: \"file-text\" },\n"
                },
                {
                    "date": 1748048902566,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,8 +92,23 @@\n   }\n `;\n \n export const TransactionForm = () => {\n+  // Component refs\n+  const formContainerRef = useRef(null);\n+  const formContentRef = useRef(null);\n+\n+  // State declarations\n+  const [currentStep, setCurrentStep] = useState(1);\n+  const [agentData, setAgentData] = useState({ role: '', name: '' });\n+  const [signatureData, setSignatureData] = useState({ signature: '', infoConfirmed: false, termsAccepted: false, agentName: '' });\n+  const [submitting, setSubmitting] = useState(false);\n+  const [showValidationUI, setShowValidationUI] = useState(false);\n+  const [validationErrors, setValidationErrors] = useState({});\n+  const [showProgressOverlay, setShowProgressOverlay] = useState(false);\n+  const [currentSubmissionStep, setCurrentSubmissionStep] = useState(0);\n+  const [submissionError, setSubmissionError] = useState(null);\n+\n   // Define form steps\n   const formSteps = [\n     { id: 1, title: \"Agent Role\", icon: \"user\" },\n     { id: 2, title: \"Property\", icon: \"home\" },\n"
                },
                {
                    "date": 1748048913959,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,13 +108,44 @@\n   const [currentSubmissionStep, setCurrentSubmissionStep] = useState(0);\n   const [submissionError, setSubmissionError] = useState(null);\n \n   // Define form steps\n+  // Constants\n   const formSteps = [\n     { id: 1, title: \"Agent Role\", icon: \"user\" },\n     { id: 2, title: \"Property\", icon: \"home\" },\n-  { id: 3, title: \"Clients\", icon: \"users\" },\n-  { id: 4, title: \"Commission\", icon: \"dollar-sign\" },\n+    { id: 3, title: \"Clients\", icon: \"users\" },\n+    { id: 4, title: \"Commission\", icon: \"dollar-sign\" },\n+  ];\n+\n+  const totalSteps = formSteps.length;\n+\n+  // Event handlers\n+  const handleFixField = (field) => {\n+    // Add your handleFixField implementation\n+  };\n+\n+  const handleSaveDraft = () => {\n+    // Add your handleSaveDraft implementation\n+  };\n+\n+  // Effects\n+  useEffect(() => {\n+    // Notify the parent component of step changes\n+    const event = new CustomEvent('stepChange', {\n+      detail: { step: currentStep }\n+    });\n+    window.dispatchEvent(event);\n+  }, [currentStep]);\n+\n+  useEffect(() => {\n+    document.body.setAttribute('data-transaction-page', 'true');\n+    return () => {\n+      document.body.removeAttribute('data-transaction-page');\n+    };\n+  }, []);\n+\n+  const formSteps = [\n   { id: 5, title: \"Property Details\", icon: \"clipboard\" },\n   { id: 6, title: \"Documents\", icon: \"file-text\" },\n   { id: 7, title: \"Additional Info\", icon: \"info\" },\n   { id: 8, title: \"Review\", icon: \"check-circle\" },\n"
                },
                {
                    "date": 1748048931526,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -107,45 +107,10 @@\n   const [showProgressOverlay, setShowProgressOverlay] = useState(false);\n   const [currentSubmissionStep, setCurrentSubmissionStep] = useState(0);\n   const [submissionError, setSubmissionError] = useState(null);\n \n-  // Define form steps\n   // Constants\n   const formSteps = [\n-    { id: 1, title: \"Agent Role\", icon: \"user\" },\n-    { id: 2, title: \"Property\", icon: \"home\" },\n-    { id: 3, title: \"Clients\", icon: \"users\" },\n-    { id: 4, title: \"Commission\", icon: \"dollar-sign\" },\n-  ];\n-\n-  const totalSteps = formSteps.length;\n-\n-  // Event handlers\n-  const handleFixField = (field) => {\n-    // Add your handleFixField implementation\n-  };\n-\n-  const handleSaveDraft = () => {\n-    // Add your handleSaveDraft implementation\n-  };\n-\n-  // Effects\n-  useEffect(() => {\n-    // Notify the parent component of step changes\n-    const event = new CustomEvent('stepChange', {\n-      detail: { step: currentStep }\n-    });\n-    window.dispatchEvent(event);\n-  }, [currentStep]);\n-\n-  useEffect(() => {\n-    document.body.setAttribute('data-transaction-page', 'true');\n-    return () => {\n-      document.body.removeAttribute('data-transaction-page');\n-    };\n-  }, []);\n-\n-  const formSteps = [\n   { id: 5, title: \"Property Details\", icon: \"clipboard\" },\n   { id: 6, title: \"Documents\", icon: \"file-text\" },\n   { id: 7, title: \"Additional Info\", icon: \"info\" },\n   { id: 8, title: \"Review\", icon: \"check-circle\" },\n"
                },
                {
                    "date": 1748048941940,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -109,9 +109,13 @@\n   const [submissionError, setSubmissionError] = useState(null);\n \n   // Constants\n   const formSteps = [\n-  { id: 5, title: \"Property Details\", icon: \"clipboard\" },\n+    { id: 1, title: \"Agent Role\", icon: \"user\" },\n+    { id: 2, title: \"Property\", icon: \"home\" },\n+    { id: 3, title: \"Clients\", icon: \"users\" },\n+    { id: 4, title: \"Commission\", icon: \"dollar-sign\" },\n+    { id: 5, title: \"Property Details\", icon: \"clipboard\" },\n   { id: 6, title: \"Documents\", icon: \"file-text\" },\n   { id: 7, title: \"Additional Info\", icon: \"info\" },\n   { id: 8, title: \"Review\", icon: \"check-circle\" },\n   { id: 9, title: \"Signature\", icon: \"pen-tool\" }\n"
                },
                {
                    "date": 1748048959016,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -114,10 +114,52 @@\n     { id: 2, title: \"Property\", icon: \"home\" },\n     { id: 3, title: \"Clients\", icon: \"users\" },\n     { id: 4, title: \"Commission\", icon: \"dollar-sign\" },\n     { id: 5, title: \"Property Details\", icon: \"clipboard\" },\n-  { id: 6, title: \"Documents\", icon: \"file-text\" },\n-  { id: 7, title: \"Additional Info\", icon: \"info\" },\n+    { id: 6, title: \"Documents\", icon: \"file-text\" },\n+    { id: 7, title: \"Additional Info\", icon: \"info\" },\n+    { id: 8, title: \"Sign & Submit\", icon: \"check-circle\" }\n+  ];\n+\n+  const totalSteps = formSteps.length;\n+\n+  // Event handlers\n+  const handleFixField = (field) => {\n+    setValidationErrors(prev => ({ ...prev, [field]: false }));\n+  };\n+\n+  const handleSaveDraft = async () => {\n+    // Implement draft saving logic\n+  };\n+\n+  // Effects\n+  useEffect(() => {\n+    const event = new CustomEvent('stepChange', {\n+      detail: { step: currentStep }\n+    });\n+    window.dispatchEvent(event);\n+  }, [currentStep]);\n+\n+  useEffect(() => {\n+    document.body.setAttribute('data-transaction-page', 'true');\n+    return () => {\n+      document.body.removeAttribute('data-transaction-page');\n+    };\n+  }, []);\n+\n+  return (\n+    <QueryClientProvider client={queryClient}>\n+      <TooltipProvider>\n+        {/* Add style tag for dropdown fixes */}\n+        <style dangerouslySetInnerHTML={{ __html: fixDropdownStyles }} />\n+        <div className=\"transaction-form-container min-h-screen\" ref={formContainerRef}>\n+          <div className=\"transaction-form-content\" ref={formContentRef}>\n+            {/* Form content will go here */}\n+          </div>\n+        </div>\n+      </TooltipProvider>\n+    </QueryClientProvider>\n+  );\n   { id: 8, title: \"Review\", icon: \"check-circle\" },\n   { id: 9, title: \"Signature\", icon: \"pen-tool\" }\n ];\n \n"
                },
                {
                    "date": 1748048983497,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -158,12 +158,11 @@\n         </div>\n       </TooltipProvider>\n     </QueryClientProvider>\n   );\n-  { id: 8, title: \"Review\", icon: \"check-circle\" },\n-  { id: 9, title: \"Signature\", icon: \"pen-tool\" }\n-];\n+};\n \n+// Main TransactionForm component\n export function TransactionForm() {\n   const { toast, dismiss } = useToast();\n   const {\n     currentStep,\n"
                },
                {
                    "date": 1748049040536,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,78 +91,8 @@\n     opacity: 1 !important;\n   }\n `;\n \n-export const TransactionForm = () => {\n-  // Component refs\n-  const formContainerRef = useRef(null);\n-  const formContentRef = useRef(null);\n-\n-  // State declarations\n-  const [currentStep, setCurrentStep] = useState(1);\n-  const [agentData, setAgentData] = useState({ role: '', name: '' });\n-  const [signatureData, setSignatureData] = useState({ signature: '', infoConfirmed: false, termsAccepted: false, agentName: '' });\n-  const [submitting, setSubmitting] = useState(false);\n-  const [showValidationUI, setShowValidationUI] = useState(false);\n-  const [validationErrors, setValidationErrors] = useState({});\n-  const [showProgressOverlay, setShowProgressOverlay] = useState(false);\n-  const [currentSubmissionStep, setCurrentSubmissionStep] = useState(0);\n-  const [submissionError, setSubmissionError] = useState(null);\n-\n-  // Constants\n-  const formSteps = [\n-    { id: 1, title: \"Agent Role\", icon: \"user\" },\n-    { id: 2, title: \"Property\", icon: \"home\" },\n-    { id: 3, title: \"Clients\", icon: \"users\" },\n-    { id: 4, title: \"Commission\", icon: \"dollar-sign\" },\n-    { id: 5, title: \"Property Details\", icon: \"clipboard\" },\n-    { id: 6, title: \"Documents\", icon: \"file-text\" },\n-    { id: 7, title: \"Additional Info\", icon: \"info\" },\n-    { id: 8, title: \"Sign & Submit\", icon: \"check-circle\" }\n-  ];\n-\n-  const totalSteps = formSteps.length;\n-\n-  // Event handlers\n-  const handleFixField = (field) => {\n-    setValidationErrors(prev => ({ ...prev, [field]: false }));\n-  };\n-\n-  const handleSaveDraft = async () => {\n-    // Implement draft saving logic\n-  };\n-\n-  // Effects\n-  useEffect(() => {\n-    const event = new CustomEvent('stepChange', {\n-      detail: { step: currentStep }\n-    });\n-    window.dispatchEvent(event);\n-  }, [currentStep]);\n-\n-  useEffect(() => {\n-    document.body.setAttribute('data-transaction-page', 'true');\n-    return () => {\n-      document.body.removeAttribute('data-transaction-page');\n-    };\n-  }, []);\n-\n-  return (\n-    <QueryClientProvider client={queryClient}>\n-      <TooltipProvider>\n-        {/* Add style tag for dropdown fixes */}\n-        <style dangerouslySetInnerHTML={{ __html: fixDropdownStyles }} />\n-        <div className=\"transaction-form-container min-h-screen\" ref={formContainerRef}>\n-          <div className=\"transaction-form-content\" ref={formContentRef}>\n-            {/* Form content will go here */}\n-          </div>\n-        </div>\n-      </TooltipProvider>\n-    </QueryClientProvider>\n-  );\n-};\n-\n-// Main TransactionForm component\n export function TransactionForm() {\n   const { toast, dismiss } = useToast();\n   const {\n     currentStep,\n"
                },
                {
                    "date": 1748049118667,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1214,44 +1214,15 @@\n     </div>\n   </>\n );\n \n-export const TransactionForm = () => {\n-  const [currentStep, setCurrentStep] = useState(1);\n+export function TransactionForm() {\n+  const { toast, dismiss } = useToast();\n+  const {\n+    currentStep,\n+    setCurrentStep,\n+    agentData,\n \n-  useEffect(() => {\n-    // Notify the parent component of step changes\n-    const event = new CustomEvent('stepChange', {\n-      detail: { step: currentStep }\n-    });\n-    window.dispatchEvent(event);\n-  }, [currentStep]);\n-\n-  // Set the data attribute when component mounts and remove on unmount\n-  useEffect(() => {\n-    document.body.setAttribute('data-transaction-page', 'true');\n-\n-    return () => {\n-      document.body.removeAttribute('data-transaction-page');\n-    };\n-  }, []);\n-\n-  return (\n-    <QueryClientProvider client={queryClient}>\n-      <TooltipProvider>\n-        {/* Add style tag for dropdown fixes */}\n-        <style dangerouslySetInnerHTML={{ __html: fixDropdownStyles }} />\n-\n-        <div ref={formContainerRef} className=\"transaction-form-container flex flex-col bg-blue-900/95 rounded-xl shadow-md min-h-screen\">\n-          <div className=\"container mx-auto px-1 sm:px-3 py-1 sm:py-3 flex-grow flex flex-col overflow-visible\">\n-            {/* Main form container with enhanced visual design */}\n-            <div ref={formContentRef} className=\"modern-form-container bg-transparent rounded-xl p-2 sm:p-3 border-0 relative flex flex-col flex-grow\" style={{ backgroundColor: 'transparent', boxShadow: 'none' }}>\n-              {/* Decorative corner accents for visual polish */}\n-              <div className=\"absolute top-0 left-0 w-12 h-12 border-t-2 border-l-2 border-blue-500/20 rounded-tl-xl pointer-events-none\"></div>\n-              <div className=\"absolute top-0 right-0 w-12 h-12 border-t-2 border-r-2 border-blue-500/20 rounded-tr-xl pointer-events-none\"></div>\n-              <div className=\"absolute bottom-0 left-0 w-12 h-12 border-b-2 border-l-2 border-blue-500/10 rounded-bl-xl pointer-events-none hidden md:block\"></div>\n-              <div className=\"absolute bottom-0 right-0 w-12 h-12 border-b-2 border-r-2 border-blue-500/10 rounded-br-xl pointer-events-none hidden md:block\"></div>\n-\n               {/* Form Content with section fade-in effect */}\n               <div className=\"space-y-4 section-fade-in flex-grow overflow-visible min-h-[400px] pb-16\" style={{ backgroundColor: 'transparent' }}>\n                 {currentStep === 1 && (\n                   <>\n"
                },
                {
                    "date": 1748051527112,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,8 +91,24 @@\n     opacity: 1 !important;\n   }\n `;\n \n+// Form steps configuration\n+const formSteps = [\n+  { title: \"Agent Role\", description: \"Select your role in this transaction\" },\n+  { title: \"Property\", description: \"Enter property details\" },\n+  { title: \"Clients\", description: \"Add client information\" },\n+  { title: \"Commission\", description: \"Enter commission details\" },\n+  { title: \"Property Details\", description: \"Additional property information\" },\n+  { title: \"Title & Escrow\", description: \"Title and escrow information\" },\n+  { title: \"Additional Info\", description: \"Any additional information\" },\n+  { title: \"Documents\", description: \"Upload required documents\" },\n+  { title: \"Review\", description: \"Review all information\" },\n+  { title: \"Sign & Submit\", description: \"Sign and submit the transaction\" }\n+];\n+\n+const totalSteps = formSteps.length;\n+\n export function TransactionForm() {\n   const { toast, dismiss } = useToast();\n   const {\n     currentStep,\n@@ -1214,8 +1230,24 @@\n     </div>\n   </>\n );\n \n+// Form steps configuration\n+const formSteps = [\n+  { title: \"Agent Role\", description: \"Select your role in this transaction\" },\n+  { title: \"Property\", description: \"Enter property details\" },\n+  { title: \"Clients\", description: \"Add client information\" },\n+  { title: \"Commission\", description: \"Enter commission details\" },\n+  { title: \"Property Details\", description: \"Additional property information\" },\n+  { title: \"Title & Escrow\", description: \"Title and escrow information\" },\n+  { title: \"Additional Info\", description: \"Any additional information\" },\n+  { title: \"Documents\", description: \"Upload required documents\" },\n+  { title: \"Review\", description: \"Review all information\" },\n+  { title: \"Sign & Submit\", description: \"Sign and submit the transaction\" }\n+];\n+\n+const totalSteps = formSteps.length;\n+\n export function TransactionForm() {\n   const { toast, dismiss } = useToast();\n   const {\n     currentStep,\n"
                },
                {
                    "date": 1748051583802,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1251,71 +1251,5 @@\n   const { toast, dismiss } = useToast();\n   const {\n     currentStep,\n     setCurrentStep,\n-    agentData,\n-\n-              {/* Form Content with section fade-in effect */}\n-              <div className=\"space-y-4 section-fade-in flex-grow overflow-visible min-h-[400px] pb-16\" style={{ backgroundColor: 'transparent' }}>\n-                {currentStep === 1 && (\n-                  <>\n-                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n-                      {/* Enhanced section header with icon and gradient accent */}\n-                      <div className=\"flex items-center mb-1\">\n-                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-white/30 to-white/10 shadow-md mr-2 border border-white/20\">\n-                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n-                            <path d=\"M14.5 22V12C14.5 10.8954 13.6046 10 12.5 10H6.5C5.39543 10 4.5 10.8954 4.5 12V22\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-                            <path d=\"M2.5 22H21.5\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-                            <path d=\"M19.5 22V6C19.5 4.89543 18.6046 4 17.5 4H14.5C13.3954 4 12.5 4.89543 12.5 6V10\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-                            <path d=\"M7.5 22V17H11.5V22\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-                          </svg>\n-                        </div>\n-                        <h2 className=\"text-lg sm:text-xl font-bold text-white\">Select Your Role</h2>\n-                      </div>\n-                      <div className=\"border-t border-white/10 my-2\"></div>\n-                      <p className=\"text-white/80 text-xs sm:text-sm pl-2 border-l-4 border-white/30 ml-1\">\n-                        This form will guide you through submitting a new real estate transaction. Please select your role to get started.\n-                      </p>\n-                    </div>\n-                    <div className=\"flex-grow flex flex-col justify-center py-8\">\n-                      <RoleSelection\n-                        selectedRole={agentData.role}\n-                        onRoleChange={(value) => setAgentData(prev => ({ ...prev, role: value }))}\n-                        agentName={agentData.name}\n-                        onAgentNameChange={(value) => {\n-                          setAgentData(prev => ({ ...prev, name: value }));\n-                          // Also update the signature data to keep it in sync\n-                          setSignatureData(prev => ({ ...prev, agentName: value }));\n-                        }}\n-                      />\n-                    </div>\n-                  </>\n-                )}\n-                {currentStep === 2 && (\n-                  <>\n-                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n-                      {/* Property Information section header with home icon */}\n-                      <div className=\"flex items-center mb-1\">\n-                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 shadow-md mr-2\">\n-                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n-                            <path d=\"M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-                            <path d=\"M9 22V12H15V22\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-                          </svg>\n-                        </div>\n-                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Property Information</h2>\n-                      </div>\n-                      <div className=\"fancy-divider my-2\"></div>\n-                      <p className=\"text-gray-600 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/30 ml-1\">\n-                        Enter property details for this transaction.\n-                      </p>\n-                    </div>\n-                    <div className=\"flex-grow py-6\">\n-                      <PropertyInformation\n-                        data={propertyData}\n-                        onChange={(field, value) => setPropertyData(prev => ({ ...prev, [field]: value }))}\n-                        role={agentData.role}\n-                      />\n-                    </div>\n-                  </>\n-                )}\n-                {currentStep === 3 && (\n-                  <>\n+    agentData,\n\\ No newline at end of file\n"
                },
                {
                    "date": 1748051706183,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1183,73 +1183,10 @@\n   );\n }\n \n \n-// Add checkMobile function at the top of the file\n-const checkMobile = () => {\n-  if (typeof window === 'undefined') return false;\n-  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n-};\n-\n-{currentStep === 9 && (\n-  <>\n-    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n-      {/* Sign & Submit section header with pen icon */}\n-      <div className=\"flex items-center mb-1\">\n-        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 shadow-md mr-2 animated-badge\">\n-          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n-            <path d=\"M12 19L19 12L22 15L15 22L12 19Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-            <path d=\"M18 13L16.5 5.5L2 2L5.5 16.5L13 18L18 13Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-            <path d=\"M2 2L9.586 9.586\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-            <path d=\"M11 13C12.1046 13 13 12.1046 13 11C13 9.89543 12.1046 9 11 9C9.89543 9 9 9.89543 9 11C9 12.1046 9.89543 13 11 13Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n-          </svg>\n-        </div>\n-        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Sign & Submit</h2>\n-      </div>\n-      <div className=\"fancy-divider my-2\"></div>\n-      <p className=\"text-blue-100 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/40 ml-1\">\n-        Please sign below to confirm all information is correct and to submit your transaction.\n-      </p>\n-    </div>\n-\n-    {/* Signature Section with enhanced styling */}\n-    <div className=\"w-full\">\n-      <div className=\"bg-transparent rounded-xl p-4 border border-slate-700/30 shadow-lg relative overflow-hidden\">\n-        {/* Subtle visual accent */}\n-        <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-green-400 via-green-500 to-green-600\"></div>\n-        <div className=\"absolute -top-14 -right-14 w-28 h-28 bg-green-500/10 rounded-full\"></div>\n-        <div className=\"absolute -bottom-10 -left-10 w-20 h-20 bg-green-500/10 rounded-full\"></div>\n-\n-        <SignatureSection\n-          data={signatureData}\n-          onChange={(field, value) => setSignatureData(prev => ({ ...prev, [field]: value }))}\n-          role={agentData.role}\n-          skippedFields={[]}\n-          onFieldFix={handleFixField}\n-        />\n-      </div>\n-    </div>\n-  </>\n-);\n-\n-// Form steps configuration\n-const formSteps = [\n-  { title: \"Agent Role\", description: \"Select your role in this transaction\" },\n-  { title: \"Property\", description: \"Enter property details\" },\n-  { title: \"Clients\", description: \"Add client information\" },\n-  { title: \"Commission\", description: \"Enter commission details\" },\n-  { title: \"Property Details\", description: \"Additional property information\" },\n-  { title: \"Title & Escrow\", description: \"Title and escrow information\" },\n-  { title: \"Additional Info\", description: \"Any additional information\" },\n-  { title: \"Documents\", description: \"Upload required documents\" },\n-  { title: \"Review\", description: \"Review all information\" },\n-  { title: \"Sign & Submit\", description: \"Sign and submit the transaction\" }\n-];\n-\n-const totalSteps = formSteps.length;\n-\n export function TransactionForm() {\n   const { toast, dismiss } = useToast();\n   const {\n     currentStep,\n     setCurrentStep,\n-    agentData,\n\\ No newline at end of file\n+    agentData,\n"
                },
                {
                    "date": 1748051735902,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -133,8 +133,88 @@\n     setDocumentsData,\n     handleStepClick,\n     handleNext,\n     handlePrevious,\n+    handleSubmit,\n+    submitting,\n+    showProgressOverlay,\n+    closeProgressOverlay,\n+    submissionSteps,\n+    currentSubmissionStep,\n+    submissionError,\n+    skippedFields,\n+    getAllSkippedFields,\n+    isFieldSkipped,\n+    showValidationUI,\n+    validationErrors,\n+    handleContinueWithErrors,\n+    handleFixValidationError,\n+    closeValidationUI\n+  } = useTransactionForm();\n+\n+  // Add refs for form container and content\n+  const formContainerRef = useRef<HTMLDivElement>(null);\n+  const formContentRef = useRef<HTMLDivElement>(null);\n+\n+  // Event handlers\n+  const handleFixField = (field: string) => {\n+    handleFixValidationError(field);\n+  };\n+\n+  const handleSaveDraft = () => {\n+    // Implement draft saving logic\n+  };\n+\n+  // Add useEffect for dispatching step change events\n+  useEffect(() => {\n+    const event = new CustomEvent('transaction-step-change', { detail: { step: currentStep } });\n+    document.dispatchEvent(event);\n+  }, [currentStep]);\n+\n+  // Add useEffect for managing data-transaction-page attribute on body\n+  useEffect(() => {\n+    document.body.setAttribute('data-transaction-page', 'true');\n+    return () => {\n+      document.body.removeAttribute('data-transaction-page');\n+    };\n+  }, []);\n+\n+  { title: \"Property Details\", description: \"Additional property information\" },\n+  { title: \"Title & Escrow\", description: \"Title and escrow information\" },\n+  { title: \"Additional Info\", description: \"Any additional information\" },\n+  { title: \"Documents\", description: \"Upload required documents\" },\n+  { title: \"Review\", description: \"Review all information\" },\n+  { title: \"Sign & Submit\", description: \"Sign and submit the transaction\" }\n+];\n+\n+const totalSteps = formSteps.length;\n+\n+export function TransactionForm() {\n+  const { toast, dismiss } = useToast();\n+  const {\n+    currentStep,\n+    setCurrentStep,\n+    agentData,\n+    setAgentData,\n+    propertyData,\n+    setPropertyData,\n+    clients,\n+    setClients,\n+    commissionData,\n+    setCommissionData,\n+    propertyDetails,\n+    setPropertyDetails,\n+    titleData,\n+    setTitleData,\n+    additionalInfo,\n+    setAdditionalInfo,\n+    signatureData,\n+    setSignatureData,\n+    documentsData,\n+    setDocumentsData,\n+    handleStepClick,\n+    handleNext,\n+    handlePrevious,\n     handleSubmit: submitTransaction,\n     submitting,\n     showProgressOverlay,\n     closeProgressOverlay,\n"
                },
                {
                    "date": 1748051763749,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -107,14 +107,15 @@\n ];\n \n const totalSteps = formSteps.length;\n \n-export function TransactionForm() {\n-  const { toast, dismiss } = useToast();\n-  const {\n-    currentStep,\n-    setCurrentStep,\n-    agentData,\n+// Return statement for TransactionForm component\n+return (\n+  <QueryClientProvider client={queryClient}>\n+    <TooltipProvider>\n+      <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80 pb-6 relative overflow-x-hidden\">\n+        <div className=\"max-w-5xl mx-auto px-4 py-8 relative\">\n+          {/* Form container */}\n     setAgentData,\n     propertyData,\n     setPropertyData,\n     clients,\n@@ -187,14 +188,15 @@\n ];\n \n const totalSteps = formSteps.length;\n \n-export function TransactionForm() {\n-  const { toast, dismiss } = useToast();\n-  const {\n-    currentStep,\n-    setCurrentStep,\n-    agentData,\n+// Return statement for TransactionForm component\n+return (\n+  <QueryClientProvider client={queryClient}>\n+    <TooltipProvider>\n+      <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80 pb-6 relative overflow-x-hidden\">\n+        <div className=\"max-w-5xl mx-auto px-4 py-8 relative\">\n+          {/* Form container */}\n     setAgentData,\n     propertyData,\n     setPropertyData,\n     clients,\n@@ -1263,10 +1265,11 @@\n   );\n }\n \n \n-export function TransactionForm() {\n-  const { toast, dismiss } = useToast();\n-  const {\n-    currentStep,\n-    setCurrentStep,\n-    agentData,\n+// Return statement for TransactionForm component\n+return (\n+  <QueryClientProvider client={queryClient}>\n+    <TooltipProvider>\n+      <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80 pb-6 relative overflow-x-hidden\">\n+        <div className=\"max-w-5xl mx-auto px-4 py-8 relative\">\n+          {/* Form container */}\n"
                },
                {
                    "date": 1748051879346,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,31 +91,14 @@\n     opacity: 1 !important;\n   }\n `;\n \n-// Form steps configuration\n-const formSteps = [\n-  { title: \"Agent Role\", description: \"Select your role in this transaction\" },\n-  { title: \"Property\", description: \"Enter property details\" },\n-  { title: \"Clients\", description: \"Add client information\" },\n-  { title: \"Commission\", description: \"Enter commission details\" },\n-  { title: \"Property Details\", description: \"Additional property information\" },\n-  { title: \"Title & Escrow\", description: \"Title and escrow information\" },\n-  { title: \"Additional Info\", description: \"Any additional information\" },\n-  { title: \"Documents\", description: \"Upload required documents\" },\n-  { title: \"Review\", description: \"Review all information\" },\n-  { title: \"Sign & Submit\", description: \"Sign and submit the transaction\" }\n-];\n-\n-const totalSteps = formSteps.length;\n-\n-// Return statement for TransactionForm component\n-return (\n-  <QueryClientProvider client={queryClient}>\n-    <TooltipProvider>\n-      <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80 pb-6 relative overflow-x-hidden\">\n-        <div className=\"max-w-5xl mx-auto px-4 py-8 relative\">\n-          {/* Form container */}\n+export function TransactionForm() {\n+  const { toast, dismiss } = useToast();\n+  const {\n+    currentStep,\n+    setCurrentStep,\n+    agentData,\n     setAgentData,\n     propertyData,\n     setPropertyData,\n     clients,\n@@ -178,27 +161,30 @@\n       document.body.removeAttribute('data-transaction-page');\n     };\n   }, []);\n \n-  { title: \"Property Details\", description: \"Additional property information\" },\n-  { title: \"Title & Escrow\", description: \"Title and escrow information\" },\n-  { title: \"Additional Info\", description: \"Any additional information\" },\n-  { title: \"Documents\", description: \"Upload required documents\" },\n-  { title: \"Review\", description: \"Review all information\" },\n-  { title: \"Sign & Submit\", description: \"Sign and submit the transaction\" }\n-];\n+  // Form steps configuration\n+  const formSteps = [\n+    { title: \"Agent Role\", description: \"Select your role in this transaction\" },\n+    { title: \"Property\", description: \"Enter property details\" },\n+    { title: \"Clients\", description: \"Add client information\" },\n+    { title: \"Commission\", description: \"Enter commission details\" },\n+    { title: \"Property Details\", description: \"Additional property information\" },\n+    { title: \"Title & Escrow\", description: \"Title and escrow information\" },\n+    { title: \"Additional Info\", description: \"Any additional information\" },\n+    { title: \"Documents\", description: \"Upload required documents\" },\n+    { title: \"Review\", description: \"Review all information\" },\n+    { title: \"Sign & Submit\", description: \"Sign and submit the transaction\" }\n+  ];\n \n-const totalSteps = formSteps.length;\n+  const totalSteps = formSteps.length;\n \n-// Return statement for TransactionForm component\n-return (\n-  <QueryClientProvider client={queryClient}>\n-    <TooltipProvider>\n-      <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80 pb-6 relative overflow-x-hidden\">\n-        <div className=\"max-w-5xl mx-auto px-4 py-8 relative\">\n-          {/* Form container */}\n-    setAgentData,\n-    propertyData,\n+  return (\n+    <QueryClientProvider client={queryClient}>\n+      <TooltipProvider>\n+        <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80 pb-6 relative overflow-x-hidden\">\n+          <div className=\"max-w-5xl mx-auto px-4 py-8 relative\">\n+            {/* Form container */}\n     setPropertyData,\n     clients,\n     setClients,\n     commissionData,\n"
                },
                {
                    "date": 1748051917486,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1249,13 +1249,4 @@\n       </TooltipProvider>\n     </QueryClientProvider>\n   );\n }\n-\n-\n-// Return statement for TransactionForm component\n-return (\n-  <QueryClientProvider client={queryClient}>\n-    <TooltipProvider>\n-      <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80 pb-6 relative overflow-x-hidden\">\n-        <div className=\"max-w-5xl mx-auto px-4 py-8 relative\">\n-          {/* Form container */}\n"
                },
                {
                    "date": 1748051950984,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,14 +5,8 @@\n import { Toaster as SonnerToaster } from \"@/components/ui/sonner\";\n import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\n import type { AgentRole, Client } from '@/types/transaction';\n \n-// Helper function to detect mobile devices\n-const checkMobile = () => {\n-  if (typeof window === 'undefined') return false;\n-  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n-};\n-\n // Initialize QueryClient outside the component\n const queryClient = new QueryClient();\n \n // All TransactionForm CSS is now consolidated in src/styles/pages/transaction-form.css\n"
                },
                {
                    "date": 1748051962612,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,8 +86,14 @@\n   }\n `;\n \n export function TransactionForm() {\n+  // Helper function to detect mobile devices\n+  const checkMobile = (): boolean => {\n+    if (typeof window === 'undefined') return false;\n+    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n+  };\n+\n   const { toast, dismiss } = useToast();\n   const {\n     currentStep,\n     setCurrentStep,\n"
                },
                {
                    "date": 1748052003294,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,8 +93,21 @@\n     return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n   };\n \n   const { toast, dismiss } = useToast();\n+\n+  // Enhanced navigation handlers\n+  const enhancedHandleNext = () => {\n+    handleNext();\n+  };\n+\n+  const enhancedHandlePrevious = () => {\n+    handlePrevious();\n+  };\n+\n+  const resetForm = () => {\n+    // Implement form reset logic\n+  };\n   const {\n     currentStep,\n     setCurrentStep,\n     agentData,\n"
                }
            ],
            "date": 1748047823927,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState, useRef } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { Toaster as SonnerToaster } from \"@/components/ui/sonner\";\nimport { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport type { AgentRole, Client } from '@/types/transaction';\n// All TransactionForm CSS is now consolidated in src/styles/pages/transaction-form.css\n\n// Import components\nimport { RoleSelection } from \"@/components/TransactionForm/RoleSelection\";\nimport { PropertyInformation } from \"@/components/TransactionForm/PropertyInformation\";\nimport { ClientInformation } from \"@/components/TransactionForm/ClientInformation\";\nimport { CommissionSection } from \"@/components/TransactionForm/CommissionSectionImproved\";\nimport { DocumentsSection } from \"@/components/TransactionForm/DocumentsSection\";\nimport { PropertyDetailsSection } from \"@/components/TransactionForm/PropertyDetailsSectionImproved\";\nimport { AdditionalInfoSection } from \"@/components/TransactionForm/AdditionalInfoSection\";\nimport { SignatureSection } from \"@/components/TransactionForm/SignatureSection\";\nimport { ReviewSection } from \"@/components/TransactionForm/ReviewSection\";\nimport { SubmissionProgress } from \"@/components/TransactionForm/SubmissionProgress\";\nimport { MobileNavBar } from \"@/components/TransactionForm/MobileNavBar\";\nimport { Button } from \"@/components/ui/button\";\nimport { ArrowLeft, ArrowRight, Send, Save, RefreshCw } from \"lucide-react\";\n\n// Import dialog components and hooks\nimport { ResetFormDialog } from \"./ResetFormDialog\";\nimport { CustomValidationDialog } from \"./CustomValidationDialog\";\nimport { useTransactionForm } from \"@/hooks/useTransactionForm\";\nimport { useToast } from \"@/hooks/use-toast\";\n\n// Import CSS via centralized helper\nimport { ensureCssImported } from \"../FixedCssImport\";\n\n// Import styling\nimport '../../styles/pages/transaction-form.css';\nimport '../../styles/pages/form-ui-fixes.css';\n\n// Ensure CSS is imported\nensureCssImported();\n\n// Add inline style to fix dropdowns\nconst fixDropdownStyles = `\n  select, select option, .select__control, .select__menu, .select__option {\n    background-color: white !important;\n    color: #1e3a8a !important;\n    opacity: 1 !important;\n    -webkit-appearance: menulist !important;\n    appearance: menulist !important;\n    background: white !important;\n  }\n\n  /* Target specific Property Status dropdown */\n  select[data-status], select[name] {\n    background-color: white !important;\n    background: white !important;\n    color: #1e3a8a !important;\n    opacity: 1 !important;\n  }\n\n  .dropdown-menu, .dropdown-content, [role=\"listbox\"],\n  .select__menu-list, .select__value-container, .select__single-value {\n    background-color: white !important;\n    color: #1e3a8a !important;\n    border: 1px solid rgba(59, 130, 246, 0.5) !important;\n    opacity: 1 !important;\n  }\n\n  /* Fix for React Select components */\n  .css-1s2u09g-control, .css-1pahdxg-control,\n  .css-26l3qy-menu, .css-4ljt47-MenuList {\n    background-color: white !important;\n    color: #1e3a8a !important;\n    opacity: 1 !important;\n    background: white !important;\n  }\n\n  /* Ensure dropdown items are visible */\n  .select__option, [role=\"option\"], .dropdown-item {\n    background-color: white !important;\n    color: #1e3a8a !important;\n    opacity: 1 !important;\n  }\n`;\n\n// Create a new QueryClient instance\nconst queryClient = new QueryClient();\n\n// Define the form steps for the StepWizard\nconst formSteps = [\n  { id: 1, title: \"Agent Role\", icon: \"user\" },\n  { id: 2, title: \"Property\", icon: \"home\" },\n  { id: 3, title: \"Clients\", icon: \"users\" },\n  { id: 4, title: \"Commission\", icon: \"dollar-sign\" },\n  { id: 5, title: \"Property Details\", icon: \"clipboard\" },\n  { id: 6, title: \"Documents\", icon: \"file-text\" },\n  { id: 7, title: \"Additional Info\", icon: \"info\" },\n  { id: 8, title: \"Review\", icon: \"check-circle\" },\n  { id: 9, title: \"Signature\", icon: \"pen-tool\" }\n];\n\nexport function TransactionForm() {\n  const { toast, dismiss } = useToast();\n  const {\n    currentStep,\n    setCurrentStep,\n    agentData,\n    setAgentData,\n    propertyData,\n    setPropertyData,\n    clients,\n    setClients,\n    commissionData,\n    setCommissionData,\n    propertyDetails,\n    setPropertyDetails,\n    titleData,\n    setTitleData,\n    additionalInfo,\n    setAdditionalInfo,\n    signatureData,\n    setSignatureData,\n    documentsData,\n    setDocumentsData,\n    handleStepClick,\n    handleNext,\n    handlePrevious,\n    handleSubmit: submitTransaction,\n    submitting,\n    showProgressOverlay,\n    closeProgressOverlay,\n    submissionSteps,\n    currentSubmissionStep,\n    submissionError,\n    skippedFields,\n    getAllSkippedFields,\n    isFieldSkipped,\n    showValidationUI,\n    validationErrors,\n    handleContinueWithErrors,\n    handleFixValidationError,\n    closeValidationUI\n  } = useTransactionForm();\n\n  // Add a ref for the form container\n  const formContainerRef = useRef<HTMLDivElement>(null);\n\n  // Add global styles to fix dropdowns\n  useEffect(() => {\n    // Create a style element\n    const styleElement = document.createElement('style');\n    styleElement.id = 'transaction-form-global-styles';\n\n    // Add CSS rules\n    styleElement.textContent = `\n      /* Global dropdown fixes */\n      select,\n      select option,\n      .select__control,\n      .select__menu,\n      .select__option,\n      [data-status],\n      .form-select {\n        background-color: white !important;\n        color: #1e3a8a !important;\n        opacity: 1 !important;\n        -webkit-appearance: menulist !important;\n        appearance: menulist !important;\n        background: white !important;\n      }\n\n      /* Custom scrollbar styling */\n      .custom-scrollbar::-webkit-scrollbar {\n        width: 8px;\n        height: 8px;\n      }\n\n      .custom-scrollbar::-webkit-scrollbar-track {\n        background: rgba(30, 58, 138, 0.1);\n        border-radius: 4px;\n      }\n\n      .custom-scrollbar::-webkit-scrollbar-thumb {\n        background: rgba(59, 130, 246, 0.5);\n        border-radius: 4px;\n        transition: all 0.2s ease;\n      }\n\n      .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n        background: rgba(59, 130, 246, 0.7);\n      }\n\n      /* Firefox scrollbar styling */\n      .custom-scrollbar {\n        scrollbar-width: thin;\n        scrollbar-color: rgba(59, 130, 246, 0.5) rgba(30, 58, 138, 0.1);\n      }\n\n      /* Direct fix for specific dropdown fields */\n      select[name=\"propertyStatus\"],\n      select[name=\"updateMls\"],\n      select[name=\"isBuiltBefore1978\"],\n      select[name=\"propertyAccessType\"] {\n        background-color: white !important;\n        background: white !important;\n        color: #1e3a8a !important;\n        opacity: 1 !important;\n        border: 1px solid rgba(59, 130, 246, 0.5) !important;\n      }\n\n      /* Fix for shadcn/ui Select components */\n      [data-radix-select-trigger],\n      [role=\"combobox\"],\n      button[id=\"status\"],\n      button[id=\"updateMls\"],\n      button[id=\"builtBefore1978\"],\n      button[id=\"propertyAccessType\"],\n      button[id=\"isWinterized\"] {\n        background-color: white !important;\n        background: white !important;\n        color: #1e3a8a !important;\n        opacity: 1 !important;\n        border: 1px solid rgba(59, 130, 246, 0.5) !important;\n      }\n\n      /* Ensure these fields always have a white background */\n      .transaction-form-container .property-status-field select,\n      .transaction-form-container .update-mls-field select,\n      .transaction-form-container .built-before-field select,\n      .transaction-form-container .property-access-field select {\n        background-color: white !important;\n        background: white !important;\n      }\n    `;\n\n    // Add to document head\n    document.head.appendChild(styleElement);\n\n    // Clean up\n    return () => {\n      const existingStyle = document.getElementById('transaction-form-global-styles');\n      if (existingStyle) {\n        document.head.removeChild(existingStyle);\n      }\n    };\n  }, []);\n\n  // Apply dropdown styling directly to all select elements\n  useEffect(() => {\n    const applySelectStyles = () => {\n      if (formContainerRef.current) {\n        const selectElements = formContainerRef.current.querySelectorAll('select');\n        selectElements.forEach(select => {\n          select.style.backgroundColor = 'white';\n          select.style.color = '#1e3a8a';\n          select.style.opacity = '1';\n          select.style.appearance = 'menulist';\n          select.style.webkitAppearance = 'menulist';\n          select.style.background = 'white';\n          select.style.borderColor = 'rgba(59, 130, 246, 0.5)';\n\n          // Add data attribute to help with CSS targeting\n          select.setAttribute('data-styled', 'true');\n\n          // Force the background to be white by adding an inline style element\n          const optionElements = select.querySelectorAll('option');\n          optionElements.forEach(option => {\n            option.style.backgroundColor = 'white';\n            option.style.color = '#1e3a8a';\n            option.style.opacity = '1';\n          });\n        });\n      }\n    };\n\n    // Apply styles initially\n    applySelectStyles();\n\n    // Set up a mutation observer to apply styles to any new select elements\n    const observer = new MutationObserver(applySelectStyles);\n\n    if (formContainerRef.current) {\n      observer.observe(formContainerRef.current, {\n        childList: true,\n        subtree: true,\n        attributes: true,\n        attributeFilter: ['style', 'class']\n      });\n    }\n\n    // Clean up\n    return () => {\n      observer.disconnect();\n    };\n  }, [currentStep]);\n\n  // Add functionality to save form draft\n  const handleSaveDraft = () => {\n    try {\n      const formData = {\n        agentData,\n        propertyData,\n        clients,\n        commissionData,\n        propertyDetails,\n        titleData,\n        additionalInfo,\n        signatureData,\n        documentsData,\n        currentStep\n      };\n\n      localStorage.setItem('transactionFormDraft', JSON.stringify(formData));\n\n      // Create a timestamp for the save\n      const now = new Date();\n      const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n\n      // Show toast with more specific information\n      toast({\n        title: \"Draft saved successfully\",\n        description: `Your form progress was saved at ${timeString}. You can return to this form later.`,\n        variant: \"default\",\n      });\n\n      // Save the timestamp of the last manual save\n      localStorage.setItem('lastManualSave', now.toString());\n    } catch (error) {\n      console.error(\"Error saving draft:\", error);\n      toast({\n        title: \"Error saving draft\",\n        description: \"There was a problem saving your draft. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  // Get the selectedRole from agentData\n  const selectedRole: AgentRole | undefined = agentData?.role || undefined;\n\n  // Create a function to update the role\n  const setSelectedRole = (role: AgentRole) => {\n    setAgentData(prev => ({ ...prev, role }));\n  };\n\n  // Function to navigate to step with missing field\n  const handleFixField = (field: string) => {\n    // First, log the field for debugging\n    console.log(`Attempting to navigate to field: ${field}`);\n\n    // Clean field name - remove any nested structure notation\n    const cleanField = field.includes('.') ? field.split('.').pop() || field : field;\n\n    // Map field names to their corresponding steps - expanded with more field variations\n    const fieldToStepMapping: Record<string, number> = {\n      // Agent fields - Step 1\n      'role': 1,\n      'agentRole': 1,\n\n      // Property fields - Step 2\n      'address': 2,\n      'propertyAddress': 2,\n      'mlsNumber': 2,\n      'mls': 2,\n      'salePrice': 2,\n      'price': 2,\n      'closingDate': 2,\n      'closing': 2,\n      'county': 2,\n      'propertyType': 2,\n      'status': 2,\n      'propertyStatus': 2,\n      'propertyAccessType': 2,\n      'accessType': 2,\n      'lockboxAccessCode': 2,\n      'lockbox': 2,\n      'accessCode': 2,\n      'isWinterized': 2,\n      'isBuiltBefore1978': 2,\n      'updateMls': 2,\n\n      // Client fields - Step 3\n      'clients': 3,\n      'client': 3,\n      'clientType': 3,\n      'name': 3,\n      'phone': 3,\n      'email': 3,\n      'maritalStatus': 3,\n      'clientAddress': 3,\n\n      // Commission fields - Step 4\n      'totalCommissionPercentage': 4,\n      'totalCommission': 4,\n      'listingAgentPercentage': 4,\n      'listingAgent': 4,\n      'buyersAgentPercentage': 4,\n      'buyersAgent': 4,\n      'brokerFee': 4,\n      'brokerFeeAmount': 4,\n      'hasBrokerFee': 4,\n      'sellersAssist': 4,\n      'hasSellersAssist': 4,\n      'sellerPaidAmount': 4,\n      'buyerPaidAmount': 4,\n      'isReferral': 4,\n      'referralParty': 4,\n      'brokerEin': 4,\n      'referralFee': 4,\n      'coordinatorFeePaidBy': 4,\n\n      // Property Details fields - Step 5\n      'municipality': 5,\n      'hoaName': 5,\n      'hoa': 5,\n      'coRequired': 5,\n      'co': 5,\n      'resaleCertRequired': 5,\n      'resaleCert': 5,\n      'firstRightOfRefusal': 5,\n      'firstRightName': 5,\n      'attorneyRepresentation': 5,\n      'attorneyName': 5,\n      'homeWarranty': 5,\n      'warrantyCompany': 5,\n      'warrantyCost': 5,\n      'warrantyPaidBy': 5,\n      'titleCompany': 5,\n\n      // Documents fields - Step 6\n      'documents': 6,\n      'confirmDocuments': 6,\n\n      // Additional Info fields - Step 7\n      'notes': 7,\n      'specialInstructions': 7,\n      'urgentIssues': 7,\n      'additionalInfo': 7,\n\n      // Review - Step 8\n      'review': 8,\n\n      // Signature fields - Step 9\n      'agentName': 9,\n      'signature': 9,\n      'infoConfirmed': 9,\n      'termsAccepted': 9,\n      'dateSubmitted': 9\n    };\n\n    // First try exact match\n    let step = fieldToStepMapping[field];\n\n    // If not found, try with the cleaned field name\n    if (!step && cleanField !== field) {\n      step = fieldToStepMapping[cleanField];\n    }\n\n    // If still not found, try to find a partial match\n    if (!step) {\n      // Look for partial matches in the field names\n      const partialMatches = Object.keys(fieldToStepMapping).filter(key =>\n        field.toLowerCase().includes(key.toLowerCase()) ||\n        key.toLowerCase().includes(field.toLowerCase())\n      );\n\n      if (partialMatches.length > 0) {\n        // Use the first match if multiple are found\n        step = fieldToStepMapping[partialMatches[0]];\n        console.log(`Using partial match: ${partialMatches[0]} for field: ${field}`);\n      }\n    }\n\n    if (step) {\n      setCurrentStep(step);\n      // Only show toast for direct \"Fix\" clicks, not for validation bypass navigation\n      if (window.location.hash !== '#bypassingValidation') {\n        toast({\n          title: \"Navigating to field\",\n          description: `Now fix the missing \"${field}\" field in step ${step}.`,\n          variant: \"default\",\n        });\n      }\n\n      // Add a temporary hash to prevent duplicate toasts\n      window.location.hash = '';\n    } else {\n      console.error(`No mapping found for field: ${field}`);\n\n      // If we still can't find it, use a fallback based on field naming patterns\n      let fallbackStep = 0;\n\n      if (field.toLowerCase().includes('client')) fallbackStep = 3;\n      else if (field.toLowerCase().includes('property')) fallbackStep = 2;\n      else if (field.toLowerCase().includes('commission') || field.toLowerCase().includes('fee')) fallbackStep = 4;\n      else if (field.toLowerCase().includes('warranty') || field.toLowerCase().includes('title')) fallbackStep = 5;\n      else if (field.toLowerCase().includes('document')) fallbackStep = 6;\n      else if (field.toLowerCase().includes('signature') || field.toLowerCase().includes('confirm')) fallbackStep = 9;\n\n      if (fallbackStep > 0) {\n        setCurrentStep(fallbackStep);\n        toast({\n          title: \"Field located\",\n          description: `Please fix the \"${field}\" field in this section.`,\n          variant: \"default\",\n        });\n      } else {\n        // As a last resort, just show the missing fields\n        toast({\n          title: \"Field not found\",\n          description: `Please check all form sections for missing fields.`,\n          variant: \"default\",\n        });\n      }\n    }\n  };\n\n  // Modify the resetForm function\n  const resetForm = () => {\n    // Clear localStorage first to ensure draft is removed\n    localStorage.removeItem('transactionFormDraft');\n    localStorage.removeItem('documentsValidated');\n\n    // Reset all form state\n    setAgentData({\n      role: \"LISTING AGENT\",\n      name: \"\",\n      email: \"\",\n      phone: \"\",\n    });\n    setPropertyData({\n      mlsNumber: \"\",\n      address: \"\",\n      salePrice: \"\",\n      status: \"OCCUPIED\",\n      isWinterized: \"NO\",\n      updateMls: \"NO\",\n      propertyAccessType: \"ELECTRONIC LOCKBOX\",\n      lockboxAccessCode: \"\",\n      county: \"\",\n      propertyType: \"RESIDENTIAL\",\n      isBuiltBefore1978: \"\",\n      closingDate: \"\",\n    });\n    setClients([]);\n    setCommissionData({\n      totalCommissionPercentage: \"\",\n      listingAgentPercentage: \"\",\n      buyersAgentPercentage: \"\",\n      hasBrokerFee: false,\n      brokerFeeAmount: \"\",\n      sellerPaidAmount: \"\",\n      buyerPaidAmount: \"\",\n      hasSellersAssist: false,\n      sellersAssist: \"\",\n      isReferral: false,\n      referralParty: \"\",\n      brokerEin: \"\",\n      referralFee: \"\",\n      coordinatorFeePaidBy: \"client\"\n    });\n    setPropertyDetails({\n      resaleCertRequired: false,\n      hoaName: \"\",\n      coRequired: false,\n      municipality: \"\",\n      firstRightOfRefusal: false,\n      firstRightName: \"\",\n      attorneyRepresentation: false,\n      attorneyName: \"\",\n      homeWarranty: false,\n      warrantyCompany: \"\",\n      warrantyCost: \"\",\n      warrantyPaidBy: \"SELLER\",\n    });\n    setTitleData({\n      titleCompany: \"\",\n      name: \"\",\n      contactName: \"\",\n      contactPhone: \"\"\n    });\n    setAdditionalInfo({\n      specialInstructions: \"\",\n      urgentIssues: \"\",\n      notes: \"\"\n    });\n    setSignatureData({\n      signature: \"\",\n      infoConfirmed: false,\n      termsAccepted: false,\n      agentName: \"\",\n      dateSubmitted: new Date().toISOString().split('T')[0],\n    });\n    setDocumentsData({\n      documents: [],\n      confirmDocuments: false\n    });\n    setCurrentStep(1);\n\n    // Dismiss any existing toasts\n    dismiss();\n\n    // Show confirmation toast with shorter duration\n    toast({\n      title: \"Form Reset\",\n      description: \"The form has been reset to its initial state.\",\n      variant: \"default\",\n      duration: 2000, // 2 seconds instead of 3\n    });\n  };\n\n  const handleSubmit = async () => {\n    try {\n      // Use the renamed submitTransaction function from useTransactionForm\n      await submitTransaction();\n    } catch (error) {\n      console.error(\"Error submitting transaction:\", error);\n    }\n  };\n\n  // Since we added the Signature section as a separate step, adjust the total steps\n  const totalSteps = 9;\n\n  // Create a ref for the form content\n  const formContentRef = React.useRef<HTMLDivElement>(null);\n\n  // Handle resize events for responsive behavior\n  useEffect(() => {\n    // Add listener for resize events\n    window.addEventListener('resize', checkMobile);\n\n    // Clean up\n    return () => window.removeEventListener('resize', checkMobile);\n  }, []);\n\n  // Fixed version with null check for targetElement and improve scroll behavior\n  useEffect(() => {\n    // Only scroll to form content if needed\n    if (formContentRef.current && formContainerRef.current) {\n      const formContent = formContentRef.current;\n      const viewportHeight = window.innerHeight;\n      const formContentRect = formContent.getBoundingClientRect();\n\n      // Only scroll if the top of the form content is not already visible in the viewport\n      // or if it's very close to the top edge\n      if (formContentRect.top < 50) {\n        // Scroll only the form container if it's a scrollable container\n        const container = formContainerRef.current.querySelector('.custom-scrollbar');\n        if (container) {\n          container.scrollTop = 0;\n        }\n      }\n    }\n  }, [currentStep]);\n\n  // Custom step click handler that adds intelligent scroll behavior\n  const handleCustomStepClick = (step: number) => {\n    // Check if scrolling is needed before changing step\n    if (formContentRef.current) {\n      const formContent = formContentRef.current;\n      const formContentRect = formContent.getBoundingClientRect();\n\n      // Only scroll if the top of the form content is not already visible\n      if (formContentRect.top < 50) {\n        // For mobile devices, ensure container scrolls to top\n        const container = formContainerRef.current?.querySelector('.custom-scrollbar');\n        if (container) {\n          container.scrollTop = 0;\n        }\n      }\n    }\n\n    // Apply the step change\n    handleStepClick(step);\n  };\n\n  // Add the onChange handler for clients\n  const clientsOnChange = (updatedClients: Client[]) => {\n    setClients(updatedClients);\n  };\n\n  // Wrapper function to avoid naming conflicts\n  const getSkippedFieldList = () => {\n    return getAllSkippedFields();\n  };\n\n  // Enhanced navigation functions with improved scrolling\n  const enhancedHandleNext = () => {\n    // Only force scroll if the form top isn't already visible\n    if (formContentRef.current) {\n      const formContent = formContentRef.current;\n      const formContentRect = formContent.getBoundingClientRect();\n\n      // Only scroll if the top of the form content is not already visible or is close to the top edge\n      if (formContentRect.top < 50) {\n        // For mobile devices, ensure container scrolls to top\n        const container = formContainerRef.current?.querySelector('.custom-scrollbar');\n        if (container) {\n          container.scrollTop = 0;\n        }\n      }\n    }\n\n    // Apply the step change\n    handleNext();\n  };\n\n  const enhancedHandlePrevious = () => {\n    // Apply the step change directly\n    handlePrevious();\n  };\n\n  // Listen for vertical step wizard clicks\n  useEffect(() => {\n    const handleVerticalStepClick = (event: CustomEvent) => {\n      if (event.detail && event.detail.step) {\n        setCurrentStep(event.detail.step);\n      }\n    };\n\n    // Add event listener\n    window.addEventListener('verticalStepClick' as any, handleVerticalStepClick);\n\n    // Cleanup\n    return () => {\n      window.removeEventListener('verticalStepClick' as any, handleVerticalStepClick);\n    };\n  }, []);\n\n  // Emit step change events\n  useEffect(() => {\n    // Notify the parent component of step changes\n    const event = new CustomEvent('stepChange', {\n      detail: { step: currentStep }\n    });\n    window.dispatchEvent(event);\n  }, [currentStep]);\n\n  // Set the data attribute when component mounts and remove on unmount\n  useEffect(() => {\n    document.body.setAttribute('data-transaction-page', 'true');\n\n    return () => {\n      document.body.removeAttribute('data-transaction-page');\n    };\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        {/* Add style tag for dropdown fixes */}\n        <style dangerouslySetInnerHTML={{ __html: fixDropdownStyles }} />\n\n        <div ref={formContainerRef} className=\"transaction-form-container flex flex-col bg-blue-900/95 rounded-xl shadow-md min-h-screen\">\n          <div className=\"container mx-auto px-1 sm:px-3 py-1 sm:py-3 flex-grow flex flex-col overflow-visible\">\n            {/* Main form container with enhanced visual design */}\n            <div ref={formContentRef} className=\"modern-form-container bg-transparent rounded-xl p-2 sm:p-3 border-0 relative flex flex-col flex-grow\" style={{ backgroundColor: 'transparent', boxShadow: 'none' }}>\n              {/* Decorative corner accents for visual polish */}\n              <div className=\"absolute top-0 left-0 w-12 h-12 border-t-2 border-l-2 border-blue-500/20 rounded-tl-xl pointer-events-none\"></div>\n              <div className=\"absolute top-0 right-0 w-12 h-12 border-t-2 border-r-2 border-blue-500/20 rounded-tr-xl pointer-events-none\"></div>\n              <div className=\"absolute bottom-0 left-0 w-12 h-12 border-b-2 border-l-2 border-blue-500/10 rounded-bl-xl pointer-events-none hidden md:block\"></div>\n              <div className=\"absolute bottom-0 right-0 w-12 h-12 border-b-2 border-r-2 border-blue-500/10 rounded-br-xl pointer-events-none hidden md:block\"></div>\n\n              {/* Form Content with section fade-in effect */}\n              <div className=\"space-y-4 section-fade-in flex-grow overflow-visible min-h-[400px] pb-16\" style={{ backgroundColor: 'transparent' }}>\n                {currentStep === 1 && (\n                  <>\n                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n                      {/* Enhanced section header with icon and gradient accent */}\n                      <div className=\"flex items-center mb-1\">\n                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-white/30 to-white/10 shadow-md mr-2 border border-white/20\">\n                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n                            <path d=\"M14.5 22V12C14.5 10.8954 13.6046 10 12.5 10H6.5C5.39543 10 4.5 10.8954 4.5 12V22\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M2.5 22H21.5\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M19.5 22V6C19.5 4.89543 18.6046 4 17.5 4H14.5C13.3954 4 12.5 4.89543 12.5 6V10\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M7.5 22V17H11.5V22\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          </svg>\n                        </div>\n                        <h2 className=\"text-lg sm:text-xl font-bold text-white\">Select Your Role</h2>\n                      </div>\n                      <div className=\"border-t border-white/10 my-2\"></div>\n                      <p className=\"text-white/80 text-xs sm:text-sm pl-2 border-l-4 border-white/30 ml-1\">\n                        This form will guide you through submitting a new real estate transaction. Please select your role to get started.\n                      </p>\n                    </div>\n                    <div className=\"flex-grow flex flex-col justify-center py-8\">\n                      <RoleSelection\n                        selectedRole={agentData.role}\n                        onRoleChange={(value) => setAgentData(prev => ({ ...prev, role: value }))}\n                        agentName={agentData.name}\n                        onAgentNameChange={(value) => {\n                          setAgentData(prev => ({ ...prev, name: value }));\n                          // Also update the signature data to keep it in sync\n                          setSignatureData(prev => ({ ...prev, agentName: value }));\n                        }}\n                      />\n                    </div>\n                  </>\n                )}\n                {currentStep === 2 && (\n                  <>\n                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n                      {/* Property Information section header with home icon */}\n                      <div className=\"flex items-center mb-1\">\n                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 shadow-md mr-2\">\n                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n                            <path d=\"M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M9 22V12H15V22\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          </svg>\n                        </div>\n                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Property Information</h2>\n                      </div>\n                      <div className=\"fancy-divider my-2\"></div>\n                      <p className=\"text-gray-600 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/30 ml-1\">\n                        Enter property details for this transaction.\n                      </p>\n                    </div>\n                    <div className=\"flex-grow py-6\">\n                      <PropertyInformation\n                        data={propertyData}\n                        onChange={(field, value) => setPropertyData(prev => ({ ...prev, [field]: value }))}\n                        role={agentData.role}\n                      />\n                    </div>\n                  </>\n                )}\n                {currentStep === 3 && (\n                  <>\n                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n                      {/* Client Information section header with people icon */}\n                      <div className=\"flex items-center mb-1\">\n                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 shadow-md mr-2\">\n                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n                            <path d=\"M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M9 11C11.2091 11 13 9.20914 13 7C13 4.79086 11.2091 3 9 3C6.79086 3 5 4.79086 5 7C5 9.20914 6.79086 11 9 11Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M23 21V19C22.9993 18.1137 22.7044 17.2528 22.1614 16.5523C21.6184 15.8519 20.8581 15.3516 20 15.13\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M16 3.13C16.8604 3.35031 17.623 3.85071 18.1676 4.55232C18.7122 5.25392 19.0078 6.11683 19.0078 7.005C19.0078 7.89318 18.7122 8.75608 18.1676 9.45769C17.623 10.1593 16.8604 10.6597 16 10.88\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          </svg>\n                        </div>\n                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Client Information</h2>\n                      </div>\n                      <div className=\"fancy-divider my-2\"></div>\n                      <p className=\"text-gray-600 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/30 ml-1\">\n                        Provide information about the client(s).\n                      </p>\n                    </div>\n                    <ClientInformation\n                      clients={clients}\n                      onChange={clientsOnChange}\n                      role={agentData.role}\n                    />\n                  </>\n                )}\n                {currentStep === 4 && (\n                  <>\n                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n                      {/* Commission Details section header with money icon */}\n                      <div className=\"flex items-center mb-1\">\n                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 shadow-md mr-2\">\n                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n                            <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M15 9.35C14.5 8.8 13.33 8 12 8C9.79 8 8 9.79 8 12C8 14.21 9.79 16 12 16C13.33 16 14.5 15.2 15 14.65\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M12 7V9\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M12 15V17\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          </svg>\n                        </div>\n                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Commission Details</h2>\n                      </div>\n                      <div className=\"fancy-divider my-2\"></div>\n                      <p className=\"text-gray-600 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/30 ml-1\">\n                        Enter commission and fee details.\n                      </p>\n                    </div>\n                    <CommissionSection\n                      data={commissionData}\n                      onChange={(field, value) => setCommissionData(prev => ({ ...prev, [field]: value }))}\n                      role={agentData.role}\n                    />\n                  </>\n                )}\n                {currentStep === 5 && (\n                  <>\n                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n                      {/* Property & Title section header with document icon */}\n                      <div className=\"flex items-center mb-1\">\n                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 shadow-md mr-2\">\n                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n                            <path d=\"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M14 2V8H20\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M16 13H8\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M16 17H8\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M10 9H9H8\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          </svg>\n                        </div>\n                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Property & Title</h2>\n                      </div>\n                      <div className=\"fancy-divider my-2\"></div>\n                      <p className=\"text-gray-600 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/30 ml-1\">\n                        Provide property and title company information.\n                      </p>\n                    </div>\n                    <PropertyDetailsSection\n                      data={propertyDetails}\n                      onChange={(field, value) => setPropertyDetails(prev => ({ ...prev, [field]: value }))}\n                      role={agentData.role}\n                      titleData={titleData}\n                      onTitleChange={(field, value) => setTitleData(prev => ({ ...prev, [field]: value }))}\n                    />\n                  </>\n                )}\n                {currentStep === 6 && (\n                  <>\n                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n                      {/* Required Documents section header with clipboard icon */}\n                      <div className=\"flex items-center mb-1\">\n                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 shadow-md mr-2\">\n                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n                            <path d=\"M16 4H18C18.5304 4 19.0391 4.21071 19.4142 4.58579C19.7893 4.96086 20 5.46957 20 6V20C20 20.5304 19.7893 21.0391 19.4142 21.4142C19.0391 21.7893 18.5304 22 18 22H6C5.46957 22 4.96086 21.7893 4.58579 21.4142C4.21071 21.0391 4 20.5304 4 20V6C4 5.46957 4.21071 4.96086 4.58579 4.58579C4.96086 4.21071 5.46957 4 6 4H8\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M15 2H9C8.44772 2 8 2.44772 8 3V5C8 5.55228 8.44772 6 9 6H15C15.5523 6 16 5.55228 16 5V3C16 2.44772 15.5523 2 15 2Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M9 12H15\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M9 16H15\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          </svg>\n                        </div>\n                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Required Documents</h2>\n                      </div>\n                      <div className=\"fancy-divider my-2\"></div>\n                      <p className=\"text-gray-600 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/30 ml-1\">\n                        Required documents for this transaction.\n                      </p>\n                    </div>\n                    <DocumentsSection\n                      data={documentsData}\n                      onChange={(field, value) => setDocumentsData(prev => ({ ...prev, [field]: value }))}\n                      role={agentData.role}\n                      titleData={titleData}\n                      propertyData={propertyData}\n                      commissionData={commissionData}\n                    />\n                  </>\n                )}\n                {currentStep === 7 && (\n                  <>\n                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n                      {/* Additional Information section header with info icon */}\n                      <div className=\"flex items-center mb-1\">\n                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 shadow-md mr-2\">\n                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n                            <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M12 16V12\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M12 8H12.01\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          </svg>\n                        </div>\n                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Additional Information</h2>\n                      </div>\n                      <div className=\"fancy-divider my-2\"></div>\n                      <p className=\"text-gray-600 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/30 ml-1\">\n                        Any additional information or special instructions.\n                      </p>\n                    </div>\n                    <AdditionalInfoSection\n                      data={additionalInfo}\n                      onChange={(field, value) => setAdditionalInfo(prev => ({ ...prev, [field]: value }))}\n                    />\n                  </>\n                )}\n                {currentStep === 8 && (\n                  <>\n                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n                      {/* Review Transaction section header with magnifying glass icon */}\n                      <div className=\"flex items-center mb-1\">\n                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 shadow-md mr-2\">\n                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n                            <path d=\"M11 19C15.4183 19 19 15.4183 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M21 21L16.65 16.65\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          </svg>\n                        </div>\n                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Review Transaction</h2>\n                      </div>\n                      <div className=\"fancy-divider my-2\"></div>\n                      <p className=\"text-gray-600 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/30 ml-1\">\n                        Please review your transaction details before proceeding to sign and submit.\n                      </p>\n                    </div>\n\n                    {/* Review Section with enhanced styling */}\n                    <div className=\"max-w-5xl mx-auto\">\n                      <div className=\"rounded-xl p-4 shadow-lg relative overflow-hidden bg-[#0d1a36]\">\n                        {/* Subtle visual accent for review section */}\n                        <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-400 via-blue-500 to-blue-600\"></div>\n                        <div className=\"absolute -top-14 -right-14 w-28 h-28 bg-blue-500/10 rounded-full\"></div>\n                        <div className=\"absolute -bottom-10 -left-10 w-20 h-20 bg-blue-500/10 rounded-full\"></div>\n\n                        {/* Missing Fields Warning is now handled within the ReviewSection component */}\n\n                        <div className=\"mt-2\">\n                          <ReviewSection\n                            data={{\n                              agentData,\n                              propertyData,\n                              clients,\n                              commissionData,\n                              propertyDetailsData: propertyDetails,\n                              titleData,\n                              additionalInfo,\n                              signatureData,\n                              documentsData\n                            }}\n                            skippedFields={getSkippedFieldList()}\n                            onFieldFix={handleFixField}\n                          />\n                        </div>\n                      </div>\n                    </div>\n                  </>\n                )}\n\n                {currentStep === 9 && (\n                  <>\n                    <div id=\"section-title\" className=\"pt-1 md:pt-2 mb-2 sm:mb-3 pb-1 sm:pb-2\">\n                      {/* Sign & Submit section header with pen icon */}\n                      <div className=\"flex items-center mb-1\">\n                        <div className=\"flex items-center justify-center rounded-full w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 shadow-md mr-2 animated-badge\">\n                          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" className=\"text-white\">\n                            <path d=\"M12 19L19 12L22 15L15 22L12 19Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M18 13L16.5 5.5L2 2L5.5 16.5L13 18L18 13Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M2 2L9.586 9.586\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                            <path d=\"M11 13C12.1046 13 13 12.1046 13 11C13 9.89543 12.1046 9 11 9C9.89543 9 9 9.89543 9 11C9 12.1046 9.89543 13 11 13Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          </svg>\n                        </div>\n                        <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent\">Sign & Submit</h2>\n                      </div>\n                      <div className=\"fancy-divider my-2\"></div>\n                      <p className=\"text-blue-100 text-xs sm:text-sm pl-2 border-l-4 border-blue-500/40 ml-1\">\n                        Please sign below to confirm all information is correct and to submit your transaction.\n                      </p>\n                    </div>\n\n                    {/* Signature Section with enhanced styling */}\n                    <div className=\"w-full\">\n                      <div className=\"bg-transparent rounded-xl p-4 border border-slate-700/30 shadow-lg relative overflow-hidden\">\n                        {/* Subtle visual accent */}\n                        <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-green-400 via-green-500 to-green-600\"></div>\n                        <div className=\"absolute -top-14 -right-14 w-28 h-28 bg-green-500/10 rounded-full\"></div>\n                        <div className=\"absolute -bottom-10 -left-10 w-20 h-20 bg-green-500/10 rounded-full\"></div>\n\n                        <SignatureSection\n                          data={signatureData}\n                          onChange={(field, value) => setSignatureData(prev => ({ ...prev, [field]: value }))}\n                          role={agentData.role}\n                          skippedFields={[]}\n                          onFieldFix={handleFixField}\n                        />\n                      </div>\n                    </div>\n                  </>\n                )}\n              </div>\n\n              {/* Form actions bar - Hidden on mobile */}\n              <div className=\"form-actions-bar relative pt-3 border-t border-gray-200 z-10 bg-white hidden sm:block\">\n                <div className=\"flex flex-wrap justify-between items-center\">\n                  <div className=\"flex items-center\">\n                    {/* Reset form button with enhanced styling */}\n                    <ResetFormDialog onReset={resetForm} />\n                    {/* Autosave indicator */}\n                    <span className=\"text-xs text-gray-500 ml-3 flex items-center\">\n                      <RefreshCw className=\"h-3 w-3 mr-1 animate-spin opacity-40\" />\n                      Autosave enabled\n                    </span>\n                  </div>\n\n                  {/* Form navigation buttons */}\n                  <div className=\"flex items-center space-x-2 mt-0 form-navigation-buttons\">\n                    <Button\n                      variant=\"outline\"\n                      className={`${currentStep === 1 ? 'opacity-0 pointer-events-none' : 'opacity-100'} transition-opacity h-8 text-sm shadow-sm bg-white border-blue-200 text-blue-700`}\n                      onClick={enhancedHandlePrevious}\n                      disabled={currentStep === 1}\n                    >\n                      <ArrowLeft className=\"mr-1 h-3 w-3\" />\n                      Previous\n                    </Button>\n\n                    {currentStep < 9 ? (\n                      <Button\n                        onClick={enhancedHandleNext}\n                        className=\"bg-blue-600 hover:bg-blue-700 h-8 text-sm shadow-sm\"\n                      >\n                        Next Step\n                        <ArrowRight className=\"ml-1 h-3 w-3\" />\n                      </Button>\n                    ) : (\n                      <Button\n                        onClick={handleSubmit}\n                        className=\"bg-green-600 hover:bg-green-700 h-8 text-sm shadow-sm relative group overflow-hidden\"\n                        disabled={submitting || !signatureData.signature || !signatureData.infoConfirmed || !signatureData.termsAccepted}\n                      >\n                        <span className=\"relative flex items-center\">\n                          {submitting ? 'Submitting...' : 'Submit Transaction'}\n                          <Send className=\"ml-1 h-3 w-3\" />\n                        </span>\n                      </Button>\n                    )}\n                  </div>\n\n                  {/* Save as draft button - moved to the side */}\n                  <div className=\"relative hidden md:block\">\n                    <Button\n                      variant=\"outline\"\n                      className=\"h-8 text-sm text-blue-600 border-blue-200 hover:bg-blue-50 shadow-sm\"\n                      onClick={handleSaveDraft}\n                    >\n                      <Save className=\"h-3 w-3 mr-1\" />\n                      Save Draft\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Mobile Navigation - Fixed at bottom - Only visible on mobile */}\n            <MobileNavBar\n              className=\"sm:hidden\"\n              currentStep={currentStep}\n              totalSteps={totalSteps}\n              onPrevious={enhancedHandlePrevious}\n              onNext={enhancedHandleNext}\n              canGoNext={currentStep === 9 ? Boolean(signatureData.signature && signatureData.infoConfirmed && signatureData.termsAccepted) : true}\n              isLastStep={currentStep === 9}\n              hasMissingFields={Boolean(getAllSkippedFields().length)}\n              onSave={handleSaveDraft}\n            />\n\n            {/* Progress indicator */}\n            {showProgressOverlay && (\n              <SubmissionProgress\n                steps={submissionSteps}\n                currentStep={currentSubmissionStep}\n                error={submissionError}\n                onClose={closeProgressOverlay}\n                isOpen={showProgressOverlay}\n              />\n            )}\n\n            {/* Toast containers */}\n            <Toaster />\n            <SonnerToaster position=\"top-center\" />\n\n            {/* Validation bypass component */}\n            {showValidationUI && (\n              <CustomValidationDialog\n                errorCount={Object.keys(validationErrors).length}\n                errors={validationErrors}\n                onContinue={handleContinueWithErrors}\n                onFix={handleFixField}\n                onClose={closeValidationUI}\n                isOpen={showValidationUI}\n              />\n            )}\n          </div>\n\n          {/* Enhanced elegant footer quote - moved outside the form container */}\n          <div className=\"text-left mt-1 mb-1 px-3 md:flex md:justify-between md:items-center text-gray-400/70\">\n            <p className=\"italic font-light text-xs\">\n              Every transaction is a work of art, carefully crafted with expertise and precision\n            </p>\n            <div className=\"text-xs mt-0.5 md:mt-0\">\n              Powered by PA Real Estate Support Services\n            </div>\n          </div>\n        </div>\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n"
        }
    ]
}